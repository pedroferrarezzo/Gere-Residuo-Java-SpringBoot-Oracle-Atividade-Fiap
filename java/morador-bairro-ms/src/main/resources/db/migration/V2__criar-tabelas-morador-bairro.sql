CREATE SEQUENCE T_MORADOR_SEQUENCE
    START WITH 1
    INCREMENT BY 1
    NOCACHE
    NOCYCLE;

CREATE SEQUENCE T_BAIRRO_SEQUENCE
    START WITH 1
    INCREMENT BY 1
    NOCACHE
    NOCYCLE;


CREATE TABLE T_MORADOR (
    id INTEGER DEFAULT T_MORADOR_SEQUENCE.NEXTVAL NOT NULL,
    id_bairro NUMBER(5) NOT NULL,
    nome_morador VARCHAR2(30) NOT NULL,
    email_morador VARCHAR2(60) NOT NULL
);

ALTER TABLE T_MORADOR
    ADD CONSTRAINT PK_T_MORADOR PRIMARY KEY (id);

ALTER TABLE T_MORADOR ADD CONSTRAINT UN_T_MORADOR_EMAIL_MORADOR
    UNIQUE (email_morador);

ALTER TABLE T_MORADOR ADD CONSTRAINT CK_T_MORADOR_EMAIL_MORADOR
    CHECK (email_morador LIKE '%_@__%.__%');


CREATE TABLE T_BAIRRO (
    id INTEGER DEFAULT T_BAIRRO_SEQUENCE.NEXTVAL NOT NULL,
    nome_bairro VARCHAR2(30) NOT NULL,
    qtd_lixeiras NUMBER(5) NOT NULL,
    peso_m_lixeiras_kg NUMBER(5) NOT NULL,
    prc_coleta NUMBER(3) DEFAULT 100,
    disponivel VARCHAR2(20) DEFAULT 'DISPONIVEL'
);

ALTER TABLE T_BAIRRO
    ADD CONSTRAINT PK_T_BAIRRO PRIMARY KEY (id);

ALTER TABLE T_BAIRRO ADD CONSTRAINT UN_T_BAIRRO
    UNIQUE (nome_bairro);


ALTER TABLE T_MORADOR ADD CONSTRAINT FK_T_MORADOR_T_BAIRRO
    FOREIGN KEY (id_bairro) REFERENCES T_BAIRRO (id);

GRANT ALTER ON T_BAIRRO TO agenda_notificacao;
GRANT REFERENCES ON T_BAIRRO TO agenda_notificacao;